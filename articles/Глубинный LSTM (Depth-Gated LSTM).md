# Глубинный LSTM (Depth-Gated LSTM)

## Abstract

In this short note, we present an extension of long short-term memory (LSTM) neural networks to using a depth gate to connect memory cells of adjacent layers. Doing so introduces a linear dependence between lower and upper layer recurrent units. Importantly, the linear dependence is gated through a gating function, which we call depth gate. This gate is a function of the lower layer memory cell, the input to and the past memory cell of this layer. We conducted experiments and verified that this new architecture of LSTMs was able to improve machine translation and language modeling performances.

 \\nipsfinalcopy 

##   [1](https://www.groundai.com/project/depth-gated-lstm/4#S1)  Introduction

Deep neural networks (DNNs) have been successfully applied to many areas, including speech \[  [1](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib1)  \]and vision \[  [2](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib2)  \]. On natural language processing tasks, recurrent neural networks (RNNs) \[  [3](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib3)  ,  [4](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib4)  ,  [5](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib5)  \]are widely used because of their ability to memorize long-term dependency.

A typical problem of training deep networks, including RNNs, is gradient diminishing and explosion. This problem is apparent when training a simple RNN. The long short-term memory (LSTM) \[  [6](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib6)  ,  [7](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib7)  \]neural networks is an extension of simple RNN \[  [3](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib3)  \]. In LSTM, a memory cell has linear dependence of its current activity and its past activity. Importantly, a forget gate is used to modulate the information flow between the past and the current activities. LSTMs also have input and output gates to modulate its input and output.

Perhaps the introduction of gating functions in\[  [6](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib6)  ,  [7](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib7)  \]is the most significant improvement to the recurrent neural networks \[  [3](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib3)  \]. More recently, the Gated Recurrent Unit \[  [8](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib8)  \]has also adopted the concept of using gates. LSTMs and GRUs are widely used in many natural language processing tasks \[  [9](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib9)  ,  [10](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib10)  \].

To construct a deep neural networks, the standard way is to stack many layers of neural networks. This however has the same problem of building simple recurrent networks. The difference here is that the error signals from the top, instead of from the last time instance, have to be back-propagated through many layers of nonlinear transformations and therefore the error signals might be either diminished or exploded.

This short note investigates an extension of LSTMs that uses a depth-gate to connect memory cells of the lower and upper layers. We review recurrent neural networks in Sec.  [ 2 ](https://www.groundai.com/project/depth-gated-lstm/4#S2 "2 Review of recurrent neural networks ‣ Depth-Gated LSTM") . Section  [ 3 ](https://www.groundai.com/project/depth-gated-lstm/4#S3 "3 The Depth-gated LSTM ‣ Depth-Gated LSTM") presents the extension. Experiments are in Sec.  [ 4 ](https://www.groundai.com/project/depth-gated-lstm/4#S4 "4 Experiments ‣ Depth-Gated LSTM") . We relate this extension with other works in Sec.  [ 5 ](https://www.groundai.com/project/depth-gated-lstm/4#S5 "5 Related works ‣ Depth-Gated LSTM") and conclude in Sec.  [ 6 ](https://www.groundai.com/project/depth-gated-lstm/4#S6 "6 Conclusions ‣ Depth-Gated LSTM") .

##   [2](https://www.groundai.com/project/depth-gated-lstm/4#S2)  Review of recurrent neural networks

A recurrent neural network \[  [3](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib3)  ,  [4](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib4)  \]has a hidden state           h           t            that depends on its past value           h           t-1            recursively; i.e.,

<table id="S2.E1" class="ltx_equation ltx_eqn_table" style="box-sizing: border-box; border-collapse: collapse; width: 648px;"><tbody style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_eqn_cell ltx_align_center" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; font-family: Georgia, serif;"><span id="S2.E1.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \bm{h}_{\text{t}}=g(\mathbf{W}_{\text{hh}}\bm{h}_{\text{t-1}}+\mathbf{W}_{%
\text{xh}}\bm{x}_{\text{t}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">hh</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xh</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(1)</span></td></tr></tbody></table>

where       g    (    ⋅    )       is usually a nonlinear function such as tanh.           x           t            is the input.           W           hh            and           W           xh            are the weight matrices.

###  2.1 Long short-term memory (LSTM)

LSTM was initially proposed in \[  [6](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib6)  ,  [7](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib7)  \]and later modified in\[  [11](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib11)  \]. We follow the implementation in\[  [11](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib11)  \], which is illustrated in Fig.  [ 1 ](https://www.groundai.com/project/depth-gated-lstm/4#S2.F1 "Figure 1 ‣ 2.1 Long short-term memory (LSTM) ‣ 2 Review of recurrent neural networks ‣ Depth-Gated LSTM") . LSTM introduces a linear dependence between its memory cells           c           t            and its past           c           t-1            . Additionally, LSTM has input and output gates. Specially, LSTM is written below as

<table id="A0.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" style="box-sizing: border-box; border-collapse: collapse; width: 648px;"><tbody id="S2.E2" style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_td ltx_align_right ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; display: table-cell; font-family: Georgia, serif;"><span id="S2.E2.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{i}_{\text{t}} " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_center ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; display: table-cell; font-family: Georgia, serif;"><span id="S2.E2.m2" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle= " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_left ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; display: table-cell; font-family: Georgia, serif;"><span id="S2.E2.m3" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\sigma(\mathbf{W}_{\text{xi}}\bm{x}_{\text{t}}+\mathbf{W}_{\text{%
hi}}\bm{h}_{\text{t-1}}+\mathbf{W}_{\text{ci}}\bm{c}_{\text{t-1}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.001em;">σ</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xi</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 2em;">% hi</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">ci</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(2)</span></td></tr></tbody><tbody id="S2.E3" style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_td ltx_align_right ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; display: table-cell; font-family: Georgia, serif;"><span id="S2.E3.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{f}_{\text{t}} " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.06em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.375em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_center ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; display: table-cell; font-family: Georgia, serif;"><span id="S2.E3.m2" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle= " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_left ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; display: table-cell; font-family: Georgia, serif;"><span id="S2.E3.m3" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\sigma(\mathbf{W}_{\text{xf}}\bm{x}_{\text{t}}+\mathbf{W}_{\text{%
hf}}\bm{h}_{\text{t-1}}+\mathbf{W}_{\text{cf}}\bm{c}_{\text{t-1}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.001em;">σ</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xf</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 2em;">% hf</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">cf</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(3)</span></td></tr></tbody><tbody id="S2.E4" style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_td ltx_align_right ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; display: table-cell; font-family: Georgia, serif;"><span id="S2.E4.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{c}_{\text{t}} " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_center ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; display: table-cell; font-family: Georgia, serif;"><span id="S2.E4.m2" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle= " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_left ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; display: table-cell; font-family: Georgia, serif;"><span id="S2.E4.m3" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{f}_{\text{t}}\odot\bm{c}_{\text{t-1}}+\bm{i}_{\text{t}}\odot
tanh%
(\mathbf{W}_{\text{xc}}\bm{x}_{\text{t}}+\mathbf{W}_{\text{hc}}\bm{h}_{\text{t%
-1}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.06em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.375em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-mi MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xc</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">hc</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 2.5em;">t% -1</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(4)</span></td></tr></tbody><tbody id="S2.E5" style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_td ltx_align_right ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; display: table-cell; font-family: Georgia, serif;"><span id="S2.E5.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{o}_{\text{t}} " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_center ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; display: table-cell; font-family: Georgia, serif;"><span id="S2.E5.m2" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle= " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_left ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; display: table-cell; font-family: Georgia, serif;"><span id="S2.E5.m3" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\sigma(\mathbf{W}_{\text{xo}}\bm{x}_{\text{t}}+\mathbf{W}_{\text{%
ho}}\bm{h}_{\text{t-1}}+\mathbf{W}_{\text{co}}\bm{c}_{\text{t}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.001em;">σ</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xo</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 2em;">% ho</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">co</span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(5)</span></td></tr></tbody><tbody id="S2.E6" style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_td ltx_align_right ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; display: table-cell; font-family: Georgia, serif;"><span id="S2.E6.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{h}_{\text{t}} " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_center ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; display: table-cell; font-family: Georgia, serif;"><span id="S2.E6.m2" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle= " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_left ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; display: table-cell; font-family: Georgia, serif;"><span id="S2.E6.m3" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{o}_{\text{t}}\odot tanh(\bm{c}_{\text{t}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-mi MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(6)</span></td></tr></tbody></table>

where           i           t            ,           f           t            and           o           t            are input gate, forget gate and output gate of LSTM.           h           t            is the output from the LSTM.       σ    (    ⋅    )       is the logistic function.       ⊙       denotes element-wise product. In our application of LSTM, the forget gate and input gate share the same parameters but are computed as           f           t         \=    1    −        i           t            . Note that bias terms are omitted in the above equations but they are applied by default.

 ![](/images/f4509ec73d1489f6e661629b83f79bf1.jpg) 

 Figure 1: LSTM

###  2.2 Stacked LSTMs

Typically, LSTMs are stacked to form deep recurrent neural networks, illustrated in the left figure of Figure  [ 2 ](https://www.groundai.com/project/depth-gated-lstm/4#S3.F2 "Figure 2 ‣ 3 The Depth-gated LSTM ‣ Depth-Gated LSTM") .

The output from the lower layer LSTM at layer       L       is           h           (     L     )           t             . With a possible affine transformation, this output is used as input           x           (     L+1     )           t             in the upper layer LSTM at layer       L    +    1       . Except for this output-input connection, there is no other connections between the two layers.

##   [3](https://www.groundai.com/project/depth-gated-lstm/4#S3)  The Depth-gated LSTM

The depth-gated LSTM (DGLSTM)  1 is illustrated in the right figure of Fig. [ 2 ](https://www.groundai.com/project/depth-gated-lstm/4#S3.F2 "Figure 2 ‣ 3 The Depth-gated LSTM ‣ Depth-Gated LSTM") . It has a depth gate that connects the memory cells           c           (     L+1     )           t             in the upper layer       L    +    1       and the memory cell           c           L          t            in the lower layer       L       . The depth-gate controls how much flow from the lower memory cell directly to the upper layer memory cell. The gate function at layer       L    +    1       at time       t       is a logistic function as

<table id="S3.E7" class="ltx_equation ltx_eqn_table" style="box-sizing: border-box; border-collapse: collapse; width: 661px;"><tbody style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 661px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_eqn_cell ltx_align_center" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; font-family: Georgia, serif;"><span id="S3.E7.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \bm{d}^{(\text{L+1})}_{\text{t}}=\sigma(\bm{b}^{(\text{L+1})}_{\text{d}}+%
\mathbf{W}^{(\text{L+1})}_{\text{xd}}\bm{x}^{(\text{L+1})}_{\text{t}}+\bm{w}^{%
(\text{L+1})}_{\text{cd}}\odot\bm{c}^{(\text{L+1})}_{\text{t-1}}+\bm{w}^{(%
\text{L+1})}_{\text{ld}}\odot\bm{c}^{(\text{L})}_{\text{t}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.003em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.001em;">σ</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">d</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xd</span></span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">w</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">cd</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">w</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">ld</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">L</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(7)</span></td></tr></tbody></table>

where           b           (     L+1     )           d             is a bias term.           W           (     L+1     )           xd             is the weight matrix to relate depth gate to the input of this layer. The past memory cell is also related via a weight vector           w           (     L+1     )           cd             . To relate the lower layer memory, it uses a weight vector           w           (     L+1     )           ld             . Note that, if lower and upper layer memory cells have different dimension,           w           (     L+1     )           ld             should be a matrix instead of a vector.

<table style="box-sizing: border-box; border-collapse: collapse; width: 984px; height: auto; margin-bottom: 15px;"><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box;"><td class="ltx_subfigure" style="box-sizing: border-box; border: 0px; font-size: 15px; padding: 0px 1rem 0px 0px;"><figure id="S3.F2.sf1" class="ltx_figure ltx_align_center" style="box-sizing: border-box; display: block; margin: 0px; position: relative; overflow: visible; text-align: center;"><img src="https://www.groundai.com/project/depth-gated-lstm/deep/media/arxiv_projects/334086/lstm.png.750x0_q75_crop.jpg" id="S3.F2.sf1.g1" class="ltx_graphics" width="152" height="335" alt="" style="box-sizing: border-box; vertical-align: middle; border-style: none; width: 0px; height: auto; margin-bottom: 15px;"><figcaption class="ltx_caption" style="box-sizing: border-box; display: block; color: rgba(0, 0, 0, 0.6); font-size: 13px; line-height: 1.5em;"><span class="ltx_tag ltx_tag_figure" style="box-sizing: border-box;">(a)<span>&nbsp;</span></span>Stacked LSTM</figcaption></figure></td><td class="ltx_subfigure" style="box-sizing: border-box; border: 0px; font-size: 15px; padding: 0px 1rem 0px 0px;"><figure id="S3.F2.sf2" class="ltx_figure ltx_align_center" style="box-sizing: border-box; display: block; margin: 0px; position: relative; overflow: visible; text-align: center;"><img src="https://www.groundai.com/project/depth-gated-lstm/dg/media/arxiv_projects/334086/lstm.png.750x0_q75_crop.jpg" id="S3.F2.sf2.g1" class="ltx_graphics" width="203" height="335" alt="" style="box-sizing: border-box; vertical-align: middle; border-style: none; width: 0px; height: auto; margin-bottom: 15px;"><figcaption class="ltx_caption" style="box-sizing: border-box; display: block; color: rgba(0, 0, 0, 0.6); font-size: 13px; line-height: 1.5em;"><span class="ltx_tag ltx_tag_figure" style="box-sizing: border-box;">(b)<span>&nbsp;</span></span>Depth-gated LSTM</figcaption></figure></td></tr></tbody></table>

 Figure 2: Illustration of the stacked LSTM and the depth-gated LSTM. Notice the additional connection between memory cells in the lower and upper layers in the depth-gated LSTM.

Using the depth gate, a DGLSTM computes the memory cell at layer       L    +    1       as follows

<table id="A0.EGx2" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" style="box-sizing: border-box; border-collapse: collapse; width: 830px;"><tbody id="S3.E8" style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 830px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_td ltx_align_right ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; display: table-cell; font-family: Georgia, serif;"><span id="S3.E8.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{c}^{(\text{L+1})}_{\text{t}} " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_center ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; display: table-cell; font-family: Georgia, serif;"><span id="S3.E8.m2" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle= " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span></span></span></span></span></span></span></span></td><td class="ltx_td ltx_align_left ltx_eqn_cell" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; display: table-cell; font-family: Georgia, serif;"><span id="S3.E8.m3" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \displaystyle\bm{d}^{(\text{L+1})}_{\text{t}}\odot\bm{c}^{(\text{L})}_{\text{t%
}}+\bm{f}^{(\text{L+1})}_{\text{t}}\odot\bm{c}^{(\text{L+1})}_{\text{t-1}}+\bm%
{i}^{(\text{L+1})}_{\text{t}}\odot tanh(\mathbf{W}^{(\text{L+1})}_{\text{xc}}%
\bm{x}^{(\text{L+1})}_{\text{t}}+\mathbf{W}^{(\text{L+1})}_{\text{hc}}\bm{h}^{%
(\text{L+1})}_{\text{t-1}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mstyle" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.003em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">L</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t%&nbsp;</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.06em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0.181em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-mi MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xc</span></span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">hc</span></span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">L+1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(8)</span></td></tr></tbody></table>

In DGLSTM, equations ( [ 2 ](https://www.groundai.com/project/depth-gated-lstm/4#S2.E2 "(2) ‣ 2.1 Long short-term memory (LSTM) ‣ 2 Review of recurrent neural networks ‣ Depth-Gated LSTM") ), ( [ 3 ](https://www.groundai.com/project/depth-gated-lstm/4#S2.E3 "(3) ‣ 2.1 Long short-term memory (LSTM) ‣ 2 Review of recurrent neural networks ‣ Depth-Gated LSTM") ), ( [ 5 ](https://www.groundai.com/project/depth-gated-lstm/4#S2.E5 "(5) ‣ 2.1 Long short-term memory (LSTM) ‣ 2 Review of recurrent neural networks ‣ Depth-Gated LSTM") ) and ( [ 6 ](https://www.groundai.com/project/depth-gated-lstm/4#S2.E6 "(6) ‣ 2.1 Long short-term memory (LSTM) ‣ 2 Review of recurrent neural networks ‣ Depth-Gated LSTM") ) are the same as the standard LSTM, except that DGLSTM uses a superscript       L    +    1       to denote operations at layer       L    +    1       .

The idea of using gated linear dependence can also be used to connect the first layer memory cell           c           (     1     )           t             with the feature observation           x           (     0     )           t             . In this case, the depth-gate is computed for       L    \=    0       as follows

<table id="S3.E9" class="ltx_equation ltx_eqn_table" style="box-sizing: border-box; border-collapse: collapse; width: 648px;"><tbody style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_eqn_cell ltx_align_center" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; font-family: Georgia, serif;"><span id="S3.E9.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \bm{d}^{(\text{1})}_{\text{t}}=\sigma(\bm{b}^{(\text{1})}_{\text{d}}+\mathbf{W%
}^{(\text{1})}_{\text{xd}}\bm{x}^{(\text{1})}_{\text{t}}+\bm{w}^{(\text{1})}_{%
\text{cd}}\odot\bm{c}^{(\text{1})}_{\text{t-1}}), " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.003em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-mi MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.001em;">σ</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">d</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xd</span></span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">w</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">cd</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(9)</span></td></tr></tbody></table>

and the memory cell is computed as

<table id="S3.E10" class="ltx_equation ltx_eqn_table" style="box-sizing: border-box; border-collapse: collapse; width: 819px;"><tbody style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 819px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_eqn_cell ltx_align_center" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; font-family: Georgia, serif;"><span id="S3.E10.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \bm{c}^{(\text{1})}_{\text{t}}=\bm{d}^{(\text{1})}_{\text{t}}\odot\left(%
\mathbf{W}^{(\text{1})}_{\text{xd}}\bm{x}^{(\text{0})}_{\text{t}}\right)+\bm{f%
}^{(\text{1})}_{\text{t}}\odot\bm{c}^{(\text{1})}_{\text{t-1}}+\bm{i}^{(\text{%
1})}_{\text{t}}\odot tanh(\mathbf{W}^{(\text{1})}_{\text{xc}}\bm{x}^{(\text{0}%
)}_{\text{t}}+\mathbf{W}^{(\text{1})}_{\text{hc}}\bm{h}^{(\text{1})}_{\text{t-%
1}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-msubsup MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.003em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-mrow MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-size2-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-size2-R, MJXc-TeX-size2-Rw; padding-top: 0.961em; padding-bottom: 0.961em;">(</span></span><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xd</span></span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">0</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-size2-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-size2-R, MJXc-TeX-size2-Rw; padding-top: 0.961em; padding-bottom: 0.961em;">)</span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.06em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0.181em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">t-1</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1.5em;">% 1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-mi MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xc</span></span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">0</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">hc</span></span></span></span></span></span></span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span><span class="mjx-stack" style="box-sizing: content-box !important; display: inline-block; text-align: left; vertical-align: -0.41em;"><span class="mjx-sup" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">1</span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: block; text-align: left; font-size: 16.968px; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 2.5em;">t-% 1</span></span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(10)</span></td></tr></tbody></table>

##   [4](https://www.groundai.com/project/depth-gated-lstm/4#S4)  Experiments

We applied DGLSTMs on two datasets. The first is BTEC Chinese to English machine translation task. Its training set consists of 44016 sentence pairs. We use its devset1 and devset 2 for validation, which in total have 1006 sentence pairs. We use its devset3 for test, which has 506 sentence pairs.

The second dataset is PennTreeBank (PTB) for language modeling. It consists of 42075 sentences for training, 3371 sentences for development, and 3762 sentences for test.

###  4.1 Machine translation results

We conducted preliminary experiments and observed that the attention model \[  [9](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib9)  \]performed better than the encoder-decoder method \[  [10](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib10)  \]. We therefore applied the attention model \[  [9](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib9)  \]in our experiments. Both encoder and decoder used recurrent neural networks in\[  [9](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib9)  \]. However, in this experiment, we only used recurrent neural networks for decoder. For encoder, we used word embedding learned in the training set.

A preliminary experiment showed that the simple RNN \[  [3](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib3)  \]performed the worst. We therefore don’t include the simple RNN results in this paper. We compared DGLSTM with GRU and LSTM. All these models used 200-dimension hidden layer. We varied the depth of RNNs. Results in Table  [ 1 ](https://www.groundai.com/project/depth-gated-lstm/4#S4.T1 "Table 1 ‣ 4.1 Machine translation results ‣ 4 Experiments ‣ Depth-Gated LSTM") show that DGLSTM outperforms LSTM and GRU in all of the tested depths.

|  Depth  |  GRU  |  LSTM  |  DGLSTM  |
| --- | --- | --- | --- |
| 3 | 33.95 | 32.43 | 34.48 |
| 5 | 32.73 | 33.52 | 33.81 |
| 10 | 30.72 | 31.99 | 32.19 |

 Table 1: BLEU scores in BTEC Chinese to English machine translation task

In another experiment for the machine translation experiment, we used attention model with DGLSTM to rescore test set k-best lists. We first trained two attention models, one was with 3 layers of DGLSTMs and the other was with 5 layers of DGLSTMs, on training set. Both used 50-dimension hidden layers. We then trained a reranker model using the development data with 100-best lists for each translation pair. The top 100 best lists were generated from the baseline. The features for the reranker models are the scores from the attention model. The 100-best lists on the test set were reranked using the trained reranker model. We ran the above described reranking processes 10 times to get an averaged BLEU scores, which was obtained using one reference. The BLEU scores are listed in Table  [ 2 ](https://www.groundai.com/project/depth-gated-lstm/4#S4.T2 "Table 2 ‣ 4.1 Machine translation results ‣ 4 Experiments ‣ Depth-Gated LSTM") . Compared to the baseline, DGLSTM improved BLEU scores by 3 points on the Test set.

|  Dataset  |  Baseline  |  DGLSTM  |
| --- | --- | --- |
| Dev | 26.61 | 30.05 |
| Test | 40.63 | 43.08 |

 Table 2: BLEU scores by reranking on BTEC Chinese to English machine translation task

###  4.2 Language modeling

We conducted experiments on PTB dataset. We trained a two layer DGLSTM. Each layer has 200 dimension vector. Test set perplexity results are shown in Table  [ 3 ](https://www.groundai.com/project/depth-gated-lstm/4#S4.T3 "Table 3 ‣ 4.2 Language modeling ‣ 4 Experiments ‣ Depth-Gated LSTM") . Compared against the previously published results on PTB dataset, DGLSTM obtained the lowest perplexity on PTB test set to our knowledge.

|  Model  |  Perplexity  |
| --- | --- |
| RNN \[  [5](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib5)  \] | 123 |
| LSTM \[  [11](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib11)  \] | 117 |
| sRNN \[  [12](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib12)  \] | 110 |
| DOT(s)-RNN \[  [12](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib12)  \] | 108 |
| DGLSTM | 96 |

 Table 3: Penn Treebank Test Set Results.

##   [5](https://www.groundai.com/project/depth-gated-lstm/4#S5)  Related works

We developed this method independently in a summer workshop and later knew the works in\[  [13](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib13)  ,  [14](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib14)  \]. In highway networks in\[  [13](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib13)  \], the output from a layer           y           t            is a linear function to the input           x           t            , in addition to the output from a nonlinear path. Both of them are gated as follows

<table id="S5.E11" class="ltx_equation ltx_eqn_table" style="box-sizing: border-box; border-collapse: collapse; width: 648px;"><tbody style="box-sizing: border-box;"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline" style="box-sizing: border-box; vertical-align: baseline; width: 648px;"><td class="ltx_eqn_cell ltx_eqn_center_padleft" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td class="ltx_eqn_cell ltx_align_center" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: center; font-family: Georgia, serif;"><span id="S5.E11.m1" class="ltx_DisplayMath" style="box-sizing: border-box;"><span class="mjpage mjpage__block" style="box-sizing: border-box;"><span class="mjx-chtml MJXc-display" style="box-sizing: border-box; display: block; line-height: 0; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 24px; letter-spacing: normal; overflow-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; margin: 1em 0px; padding: 0px;"><span class="mjx-math" aria-label=" \bm{y}_{\text{t}}=\mathbf{H}(\bm{x}_{\text{t}},\mathbf{W}_{\text{hh}})\odot%
\mathbf{T}(\bm{x}_{\text{t}},\mathbf{W}_{\text{xT}})+\bm{x}_{\text{t}}\odot%
\mathbf{C}(\bm{x}_{\text{t}},\mathbf{W}_{\text{c}}) " style="box-sizing: border-box; display: inline-block; border-collapse: separate; border-spacing: 0px;"><span class="mjx-mrow" aria-hidden="true" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-right: -0.006em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.375em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span class="mjx-texatom MJXc-space3" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.278em;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">H</span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span><span class="mjx-msubsup MJXc-space1" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.167em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">hh</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-texatom MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">T</span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span><span class="mjx-msubsup MJXc-space1" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.167em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 1em;">xT</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span class="mjx-texatom MJXc-space2" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.222em;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">C</span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-msubsup" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-math-I" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">t</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span><span class="mjx-msubsup MJXc-space1" style="box-sizing: content-box !important; display: inline-block; text-align: left; margin-left: 0.167em;"><span class="mjx-base" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mi" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-B" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-B, MJXc-TeX-main-Bx, MJXc-TeX-main-Bw; padding-top: 0.372em; padding-bottom: 0.372em;">W</span></span></span></span></span><span class="mjx-sub" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; vertical-align: -0.325em; padding-right: 0.071em;"><span class="mjx-texatom" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mrow" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-mtext" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; padding-top: 0.519em; padding-bottom: 0.225em;"><span class="mjx-charbox MJXc-font-inherit" style="box-sizing: content-box !important; display: inline-block; text-align: left; font-size: 16.968px; padding-bottom: 0.3em; width: 0.5em;">c</span></span></span></span></span></span></span><span class="mjx-mo" style="box-sizing: content-box !important; display: inline-block; text-align: left;"><span class="mjx-char MJXc-TeX-main-R" style="box-sizing: content-box !important; display: block; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span></td><td class="ltx_eqn_cell ltx_eqn_center_padright" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; font-family: Georgia, serif;"></td><td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" style="box-sizing: border-box; border: none; font-size: inherit; padding: 0px; text-align: right; vertical-align: middle; font-family: Georgia, serif;"><span class="ltx_tag ltx_tag_equation ltx_align_right" style="box-sizing: border-box; text-align: right;">(11)</span></td></tr></tbody></table>

where         T         and         C         are called transform gate and carry gate, respectively.         H      (    ⋅    )       is the output from a nonlinear path.           W           hh            ,           W           xT            , and           W           c            are matrices. Therefore, the highway network output has a direct and linear connection, albeit gated, to the input. This allows highway networks to train extremely deep networks easily.

DGLSTM is related to the highway networks in using the same idea of linear and gated connection to input. It differs from the highway networks in not using a specific gate on the non-linear path; DGLSTM keeps the input and output gates which are applied on the non-linear transformations in LSTMs. However, the overall effect of using the input and output gates may be similar to the transfer gate in the highway networks. An additional but important difference is that DGLSTM linearly connects the memory cells in the lower and upper layers. Because of this, the memory cell in DGLSTM has errors back-propagated both from the future and from the top layer, linearly albeit gated. This might be the biggest difference from the highway networks \[  [13](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib13)  \]in its current implementation.

Perhaps the closet work to this research is Grid LSTM \[  [14](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib14)  \], which uses LSTMs in different dimensions and connects them using gated linear connections. Because the dimensions can include not only time, as the typical recurrent neural networks, but also depth and others, Grid LSTM is more general than DGLSTM, which only considers time and depth. Also, Grid LSTM uses a generic form of input, memory, and output. Doing so allows a memory cell to have a gated linear dependence not only on its past memory cell but also on the past observations. Therefore, we consider DGLSTM as a specific and simple case of Grid LSTM that has gate applied to time and depth only on memory cells. However, DGLSTM, Grid LSTM and highway networks share the same idea of stacking networks with both linear but gated connections and nonlinear paths. This idea can be applied to fully connected, convolutional or recurrent layers.

##   [6](https://www.groundai.com/project/depth-gated-lstm/4#S6)  Conclusions

We have presented a depth-gated LSTM architecture, which uses a depth-gate to have gated linear connection between lower and upper layer memory cells. We observed better performances using this new architecture on machine translation and language modeling tasks. This architecture is related to the highway networks \[  [13](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib13)  \]and Grid LSTM \[  [14](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib14)  \]in using an additional linear connection with gates to regulate information flow across layers.

##   [7](https://www.groundai.com/project/depth-gated-lstm/4#S7)  Acknowledgment

We thank Juergen Schmidhuber for pointing out highway networks \[  [13](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib13)  \]and grid LSTM \[  [14](https://www.groundai.com/project/depth-gated-lstm/4#bib.bib14)  \]works.